{"paragraphs":[{"text":"%md\n## Using Zeppelin for Data Science Tasks: Data Ingestion, Data Formatting, Exploratory Analysis and Model Building.\n\n\nData Science involves a typical sequence of tasks: aquiring data, cleaning it, analyzing it for relationships, and then building a model. Zeppelin allows you to do all these from one unified interface.","dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Using Zeppelin for Data Science Tasks: Data Ingestion, Data Formatting, Exploratory Analysis and Model Building.</h2>\n<p>Data Science involves a typical sequence of tasks: aquiring data, cleaning it, analyzing it for relationships, and then building a model. Zeppelin allows you to do all these from one unified interface.</p>\n"}]},"apps":[],"jobName":"paragraph_1490307733026_-1040706295","id":"20170213-230537_2055290175","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:371"},{"text":"%md\n#### First, let's load the data into HDFS and make sure we can access it.","user":"anonymous","dateUpdated":"2017-03-23T22:25:32+0000","config":{"colWidth":12,"editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>First, let&rsquo;s load the data into HDFS and make sure we can access it.</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1490307733031_-1042630040","id":"20170216-235942_1412271244","dateCreated":"2017-03-23T22:22:13+0000","dateStarted":"2017-03-23T22:23:05+0000","dateFinished":"2017-03-23T22:23:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:372"},{"text":"%sh\n\nmkdir /tmp/trucking\nrm -rf /tmp/trucking/*\ncd /tmp/trucking\nwget -O /tmp/trucking/trucking.zip https://raw.githubusercontent.com/Gregw135/SparkStreamingTruckingDemo/master/zeppelin/trucking.zip?raw=true\nunzip /tmp/trucking/trucking.zip\nrm /tmp/trucking/trucking.zip\n\n# Remove existing (if any) copy of data from HDFS. You could do this with Ambari file view.\nhdfs dfs -mkdir /tmp/trucking/\nhdfs dfs -rmr -f /tmp/trucking/* -skipTrash\n\n# Move downloaded JSON file from local storage to HDFS\nhdfs dfs -put /tmp/trucking/* /tmp/trucking\n","user":"anonymous","dateUpdated":"2017-03-23T22:36:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mkdir: cannot create directory `/tmp/trucking': File exists\n--2017-03-23 22:36:21--  https://raw.githubusercontent.com/Gregw135/SparkStreamingTruckingDemo/master/zeppelin/trucking.zip?raw=true\nResolving raw.githubusercontent.com... 151.101.128.133, 151.101.0.133, 151.101.192.133, ...\nConnecting to raw.githubusercontent.com|151.101.128.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 181448 (177K) [application/zip]\nSaving to: “/tmp/trucking/trucking.zip”\n\n     0K .......... .......... .......... .......... .......... 28% 2.48M 0s\n    50K .......... .......... .......... .......... .......... 56% 5.91M 0s\n   100K .......... .......... .......... .......... .......... 84% 4.53M 0s\n   150K .......... .......... .......                         100% 5.56M=0.04s\n\n2017-03-23 22:36:21 (3.97 MB/s) - “/tmp/trucking/trucking.zip” saved [181448/181448]\n\nArchive:  /tmp/trucking/trucking.zip\n  inflating: trucking.txt            \nrmr: DEPRECATED: Please use 'rm -r' instead.\n"}]},"apps":[],"jobName":"paragraph_1490307797607_-1083939379","id":"20170323-222317_2126193409","dateCreated":"2017-03-23T22:23:17+0000","dateStarted":"2017-03-23T22:36:21+0000","dateFinished":"2017-03-23T22:36:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:373"},{"text":"\nimport org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.mllib.regression.LabeledPoint\nimport org.apache.spark.mllib.regression.LinearRegressionModel\nimport org.apache.spark.mllib.regression.LinearRegressionWithSGD\nimport org.apache.spark.mllib.regression.StreamingLinearRegressionWithSGD\nimport org.apache.spark.sql.SQLContext\n\ncase class TruckData(eventTime: Long, truckId: Int, driverId: Int, driverName: String,\n                                       routeId: Int, routeName: String, latitude: Double, longitude: Double,\n                                       speed: Int, eventType: String, foggy: Int, rainy: Int, windy: Int, congestionLevel: Int, isViolation: Int)\n//case class WindowedDriverStats(driverId: Int, averageSpeed: Int, totalFog: Int, totalRain: Int, totalWind: Int, totalViolations: Int)\n//case class TruckData(driver: Int, avgSpeed: Float, fogEvents: Int, rainEvents: Int, windEvents: Int, violations: Int, timestamp: Long)\n\nval truckData = sc.textFile(\"hdfs:///tmp/trucking/*\")\n\n//Print raw input\nprintln(\"\\nRaw input data:\")\ntruckData.take(5).foreach(println)\nSystem.out.println(\"\\n\")\n\n//Create a Dataframe\nval truckRDD = truckData.map(_.split('|'))\n    .map(atts => {\n        var eventType = atts(9)\n        var isViolation = 0\n        if(!eventType.equals(\"Normal\"))\n            isViolation=1\n        TruckData(atts(0).toLong, atts(1).toInt, atts(2).toInt, atts(3), atts(4).toInt, atts(5), atts(6).toDouble, atts(7).toDouble, atts(8).toInt, atts(9),\n        atts(10).toInt, atts(10).toInt, atts(12).toInt, atts(13).toInt, isViolation)\n        })\nval truckDf = truckRDD.toDF()\ntruckDf.show()\n\n\ntruckDf.registerTempTable(\"truckingEvents\")\n","user":"anonymous","dateUpdated":"2017-03-23T22:41:51+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.mllib.linalg.Vectors\n\nimport org.apache.spark.mllib.regression.LabeledPoint\n\nimport org.apache.spark.mllib.regression.LinearRegressionModel\n\nimport org.apache.spark.mllib.regression.LinearRegressionWithSGD\n\nimport org.apache.spark.mllib.regression.StreamingLinearRegressionWithSGD\n\nimport org.apache.spark.sql.SQLContext\n\ndefined class TruckData\n\ntruckData: org.apache.spark.rdd.RDD[String] = hdfs:///tmp/trucking/* MapPartitionsRDD[1] at textFile at <console>:35\n\nRaw input data:\n1486669632837|30|1|Edgar Orendain|101|Joplin to Kansas City|37.16031654673677|-94.46044921875|79|Normal|0|0|0|52\n1486669631764|30|1|Edgar Orendain|101|Joplin to Kansas City|37.309014074275915|-94.306640625|77|Normal|1|1|1|52\n1486669634965|37|1|Edgar Orendain|101|Joplin to Kansas City|37.02886944696474|-94.581298828125|79|Normal|0|0|1|52\n1486669633888|30|1|Edgar Orendain|101|Joplin to Kansas City|37.02886944696474|-94.581298828125|79|Normal|0|0|0|52\n1486669638088|37|1|Edgar Orendain|101|Joplin to Kansas City|37.65773212628274|-94.295654296875|81|Normal|0|0|1|52\n\ntruckRDD: org.apache.spark.rdd.RDD[TruckData] = MapPartitionsRDD[3] at map at <console>:40\n\ntruckDf: org.apache.spark.sql.DataFrame = [eventTime: bigint, truckId: int, driverId: int, driverName: string, routeId: int, routeName: string, latitude: double, longitude: double, speed: int, eventType: string, foggy: int, rainy: int, windy: int, congestionLevel: int, isViolation: int]\n+-------------+-------+--------+--------------+-------+--------------------+------------------+----------------+-----+--------------------+-----+-----+-----+---------------+-----------+\n|    eventTime|truckId|driverId|    driverName|routeId|           routeName|          latitude|       longitude|speed|           eventType|foggy|rainy|windy|congestionLevel|isViolation|\n+-------------+-------+--------+--------------+-------+--------------------+------------------+----------------+-----+--------------------+-----+-----+-----+---------------+-----------+\n|1486669632837|     30|       1|Edgar Orendain|    101|Joplin to Kansas ...| 37.16031654673677| -94.46044921875|   79|              Normal|    0|    0|    0|             52|          0|\n|1486669631764|     30|       1|Edgar Orendain|    101|Joplin to Kansas ...|37.309014074275915|   -94.306640625|   77|              Normal|    1|    1|    1|             52|          0|\n|1486669634965|     37|       1|Edgar Orendain|    101|Joplin to Kansas ...| 37.02886944696474|-94.581298828125|   79|              Normal|    0|    0|    1|             52|          0|\n|1486669633888|     30|       1|Edgar Orendain|    101|Joplin to Kansas ...| 37.02886944696474|-94.581298828125|   79|              Normal|    0|    0|    0|             52|          0|\n|1486669638088|     37|       1|Edgar Orendain|    101|Joplin to Kansas ...| 37.65773212628274|-94.295654296875|   81|              Normal|    0|    0|    1|             52|          0|\n|1486669635983|     37|       1|Edgar Orendain|    101|Joplin to Kansas ...| 37.16031654673677| -94.46044921875|   81|              Normal|    0|    0|    0|             52|          0|\n|1486669647410|     13|       1|Edgar Orendain|    101|Joplin to Kansas ...| 38.33303882235456|  -94.3505859375|   79|              Normal|    0|    0|    0|             53|          0|\n|1486669639100|     37|       1|Edgar Orendain|    101|Joplin to Kansas ...|38.004819966413194| -94.37255859375|   83|              Normal|    0|    0|    0|             53|          0|\n|1486669650493|     13|       1|Edgar Orendain|    101|Joplin to Kansas ...|37.309014074275915|   -94.306640625|   79|              Normal|    0|    0|    0|             52|          0|\n|1486669648421|     13|       1|Edgar Orendain|    101|Joplin to Kansas ...|38.004819966413194| -94.37255859375|   77|              Normal|    1|    1|    1|             52|          0|\n|1486669654636|     49|       1|Edgar Orendain|    101|Joplin to Kansas ...| 37.16031654673677| -94.46044921875|   73|Unsafe Tail Distance|    1|    1|    1|             52|          1|\n|1486669651501|     13|       1|Edgar Orendain|    101|Joplin to Kansas ...| 37.16031654673677| -94.46044921875|   77|              Normal|    0|    0|    0|             52|          0|\n|1486669670151|      4|       6| Robert Molina|    101|Joplin to Kansas ...|37.309014074275915|   -94.306640625|   41|              Normal|    0|    0|    0|             48|          0|\n|1486669668095|      4|       6| Robert Molina|    101|Joplin to Kansas ...| 37.02886944696474|-94.581298828125|   41|              Normal|    1|    1|    0|             48|          0|\n|1486669683573|     14|       6| Robert Molina|    101|Joplin to Kansas ...|37.309014074275915|   -94.306640625|   47|              Normal|    0|    0|    0|             48|          0|\n|1486669680406|     14|       6| Robert Molina|    101|Joplin to Kansas ...| 38.33303882235456|  -94.3505859375|   45|              Normal|    0|    0|    1|             48|          0|\n|1486669697903|     19|       6| Robert Molina|    101|Joplin to Kansas ...| 38.66835610151509|-94.383544921875|   51|              Normal|    0|    0|    0|             50|          0|\n|1486669690764|     44|       6| Robert Molina|    101|Joplin to Kansas ...|38.004819966413194| -94.37255859375|   51|              Normal|    0|    0|    1|             49|          0|\n|1486669703048|     19|       6| Robert Molina|    101|Joplin to Kansas ...| 37.16031654673677| -94.46044921875|   51|              Normal|    0|    0|    1|             50|          0|\n|1486669699965|     19|       6| Robert Molina|    101|Joplin to Kansas ...|38.004819966413194| -94.37255859375|   49|              Normal|    0|    0|    0|             50|          0|\n+-------------+-------+--------+--------------+-------+--------------------+------------------+----------------+-----+--------------------+-----+-----+-----+---------------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1490307733031_-1042630040","id":"20170217-000418_2144452585","dateCreated":"2017-03-23T22:22:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:374","dateFinished":"2017-03-23T22:42:42+0000","dateStarted":"2017-03-23T22:41:51+0000"},{"text":"%md\n## Let's do some Exploratory Data Analysis so that we have a better grasp on the nature of this data set.","dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Let's do some Exploratory Data Analysis so that we have a better grasp on the nature of this data set.</h2>\n"}]},"apps":[],"jobName":"paragraph_1490307733032_-1044553784","id":"20170217-000448_1927917365","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:375"},{"text":"%sql\n\nselect driverName, sum(isViolation)/count(*) as avgViolations, avg(speed) as avgSpeed, avg(foggy) as avgFog, avg(rainy) as avgRain, avg(windy) as avgWind, avg(congestionLevel) as avgCongestion from truckingEvents group by driverName order by avgViolations desc limit 10","dateUpdated":"2017-03-23T22:43:40+0000","config":{"colWidth":12,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"driverName","index":0,"aggr":"sum"}],"values":[{"name":"avgViolations","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"driverName","index":0,"aggr":"sum"},"yAxis":{"name":"avgViolations","index":1,"aggr":"sum"}}}}],"enabled":true,"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"driverName\tavgViolations\tavgSpeed\tavgFog\tavgRain\tavgWind\tavgCongestion\nRafael Coss\t0.4050314465408805\t75.52075471698113\t0.34591194968553457\t0.34591194968553457\t0.28176100628930817\t53.12012578616352\nEdgar Orendain\t0.33104738154613467\t72.10224438902743\t0.29925187032418954\t0.29925187032418954\t0.279925187032419\t52.80049875311721\nMushtaq Rizvi\t0.32397003745318353\t73.21223470661673\t0.284019975031211\t0.284019975031211\t0.26841448189762795\t43.837078651685395\nOksana Walton\t0.1292270531400966\t51.278985507246375\t0.15458937198067632\t0.15458937198067632\t0.21618357487922704\t48.72403381642512\nJames Medel\t0.11589805825242719\t54.30339805825243\t0.14563106796116504\t0.14563106796116504\t0.24029126213592233\t53.17354368932039\nRobert Molina\t0.010625\t57.01875\t0.065\t0.065\t0.198125\t43.063125\nLisa Sensmeier\t0.005714285714285714\t53.43555555555555\t0.07111111111111111\t0.07111111111111111\t0.19746031746031745\t43.24\nRobert Hryniewicz\t0.0056179775280898875\t57.23096129837703\t0.08302122347066167\t0.08302122347066167\t0.20224719101123595\t46.12921348314607\n"}]},"apps":[],"jobName":"paragraph_1490307733032_-1044553784","id":"20170217-000451_2116316706","dateCreated":"2017-03-23T22:22:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:376","user":"anonymous","dateFinished":"2017-03-23T22:43:45+0000","dateStarted":"2017-03-23T22:43:40+0000"},{"text":"%md\n## Do certified drivers have less violations?","dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Do certified drivers have less violations?</h2>\n"}]},"apps":[],"jobName":"paragraph_1490307733033_-1044938533","id":"20170217-000513_285534352","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:377"},{"text":"%sql\n\nselect foggy, sum(isViolation)/count(*) from truckingEvents  group by foggy","dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"foggy\t_c1\n0\t0.05006162889921305\n1\t0.6892703862660944\n"}]},"apps":[],"jobName":"paragraph_1490307733033_-1044938533","id":"20170217-000524_1408044289","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:378"},{"text":"%sql\n\nselect speed, sum(isViolation)/count(*) from truckingEvents  group by speed","dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"speed\t_c1\n35\t0.062370062370062374\n37\t0.0625\n39\t0.0794044665012407\n41\t0.05970149253731343\n43\t0.059322033898305086\n45\t0.05191256830601093\n47\t0.05785123966942149\n49\t0.044444444444444446\n50\t0.25806451612903225\n51\t0.06388888888888888\n52\t0.2532467532467532\n53\t0.041189931350114416\n54\t0.33557046979865773\n55\t0.08450704225352113\n56\t0.38016528925619836\n57\t0.10927835051546392\n58\t0.33962264150943394\n59\t0.1640926640926641\n60\t0.336734693877551\n61\t0.1225296442687747\n62\t0.2845528455284553\n63\t0.1368421052631579\n64\t0.22435897435897437\n65\t0.146\n66\t0.3192771084337349\n67\t0.15024630541871922\n68\t0.32934131736526945\n69\t0.1223175965665236\n70\t0.39751552795031053\n71\t0.07640449438202247\n72\t0.42735042735042733\n73\t0.09502262443438914\n74\t0.3900709219858156\n75\t0.06280193236714976\n76\t0.37410071942446044\n77\t0.36231884057971014\n78\t0.28\n79\t0.2962962962962963\n80\t0.35514018691588783\n81\t0.40425531914893614\n82\t0.36607142857142855\n83\t0.4444444444444444\n84\t0.3291139240506329\n85\t0.4827586206896552\n86\t0.35294117647058826\n87\t0.3939393939393939\n88\t0.4\n89\t0.425\n90\t0.3188405797101449\n91\t0.5\n92\t0.38823529411764707\n93\t0.3783783783783784\n94\t0.3870967741935484\n95\t0.288135593220339\n96\t0.32142857142857145\n97\t0.27419354838709675\n98\t0.308411214953271\n99\t0.24242424242424243\n100\t0.3\n101\t0.4444444444444444\n103\t0.6285714285714286\n105\t0.525\n"}]},"apps":[],"jobName":"paragraph_1490307733033_-1044938533","id":"20170217-000535_830852071","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:379"},{"text":"%sql\n\nselect rainy, sum(isViolation)/count(*) from truckingEvents  group by rainy","dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"rainy\t_c1\n0\t0.05006162889921305\n1\t0.6892703862660944\n"}]},"apps":[],"jobName":"paragraph_1490307733034_-1043784287","id":"20170217-000601_1988526888","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:380"},{"text":"%sql\n\nselect windy, sum(isViolation)/count(*) from truckingEvents  group by windy","dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"windy\t_c1\n0\t0.12860625761885414\n1\t0.2861852950873722\n"}]},"apps":[],"jobName":"paragraph_1490307733034_-1043784287","id":"20170217-000616_262578203","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:381"},{"text":"%sql\n\nselect congestionLevel, sum(isViolation)/count(*) from truckingEvents  group by congestionLevel","dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"congestionLevel\t_c1\n31\t0.1532258064516129\n32\t0.13043478260869565\n33\t0.25882352941176473\n34\t0.2028985507246377\n35\t0.0963855421686747\n36\t0.19298245614035087\n37\t0.13307984790874525\n38\t0.16728624535315986\n39\t0.12211221122112212\n40\t0.034220532319391636\n41\t0.1162079510703364\n42\t0.04065040650406504\n43\t0.05660377358490566\n44\t0.12949640287769784\n45\t0.14989293361884368\n46\t0.14161220043572983\n47\t0.12734864300626306\n48\t0.1445993031358885\n49\t0.18327183271832717\n50\t0.1726315789473684\n51\t0.21650485436893205\n52\t0.2506053268765133\n53\t0.13863216266173753\n54\t0.22758620689655173\n55\t0.2048611111111111\n56\t0.2422360248447205\n57\t0.21794871794871795\n58\t0.19469026548672566\n59\t0.20967741935483872\n60\t0.18235294117647058\n61\t0.2268041237113402\n62\t0.2962962962962963\n63\t0.15384615384615385\n64\t0.2916666666666667\n65\t0.3584905660377358\n66\t0.3191489361702128\n67\t0.14285714285714285\n68\t0.21153846153846154\n69\t0.18446601941747573\n70\t0.45\n21\t0.0\n22\t0.0\n23\t0.0\n24\t0.07954545454545454\n25\t0.1111111111111111\n26\t0.024390243902439025\n27\t0.06382978723404255\n28\t0.019230769230769232\n29\t0.038834951456310676\n30\t0.06578947368421052\n"}]},"apps":[],"jobName":"paragraph_1490307733035_-1044169036","id":"20170217-000627_36854599","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:382"},{"text":"%sql\n\nselect latitude, longitude, eventType, foggy from truckingEvents where isViolation > 0 and foggy = 1 group by latitude, longitude, eventType, foggy","dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"latitude","index":0,"aggr":"sum"}],"values":[{"name":"longitude","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"latitude","index":0,"aggr":"sum"},"yAxis":{"name":"longitude","index":1,"aggr":"sum"}}}}],"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"latitude\tlongitude\teventType\tfoggy\n38.96795115401593\t-93.01025390625\tUnsafe Tail Distance\t1\n39.69873414348139\t-90.626220703125\tSpeeding\t1\n38.831149809348744\t-91.1865234375\tUnsafe Tail Distance\t1\n38.039438891821746\t-91.549072265625\tLane Departure\t1\n39.75787999202175\t-93.93310546875\tUnsafe Tail Distance\t1\n38.98503278695909\t-94.383544921875\tLane Departure\t1\n39.740986355883564\t-89.9560546875\tUnsafe Follow Distance\t1\n42.21224516288584\t-88.6376953125\tUnsafe Tail Distance\t1\n38.92522904714054\t-92.845458984375\tLane Departure\t1\n39.7663252565449\t-92.57080078125\tLane Departure\t1\n36.46547188679816\t-95.350341796875\tLane Departure\t1\n41.65649719441145\t-90.823974609375\tUnsafe Tail Distance\t1\n36.36822190085111\t-95.504150390625\tSpeeding\t1\n41.73852846935917\t-91.47216796875\tUnsafe Follow Distance\t1\n37.65773212628274\t-94.295654296875\tUnsafe Tail Distance\t1\n35.11990857099681\t-90.68115234375\tLane Departure\t1\n38.831149809348744\t-90.791015625\tSpeeding\t1\n38.95086540091999\t-92.625732421875\tUnsafe Follow Distance\t1\n35.20972164522138\t-90.37353515625\tUnsafe Follow Distance\t1\n39.74943369178244\t-91.197509765625\tSpeeding\t1\n39.36827914916011\t-94.361572265625\tUnsafe Tail Distance\t1\n41.89409955811395\t-87.659912109375\tLane Departure\t1\n41.68932225997044\t-93.36181640625\tUnsafe Follow Distance\t1\n37.21283151445594\t-93.33984375\tUnsafe Tail Distance\t1\n39.0959629363055\t-89.736328125\tUnsafe Follow Distance\t1\n41.705728515237524\t-91.318359375\tLane Departure\t1\n42.114523952464246\t-88.406982421875\tUnsafe Follow Distance\t1\n39.14710270770074\t-94.5703125\tSpeeding\t1\n39.67337039176558\t-91.8017578125\tSpeeding\t1\n37.47485808497102\t-89.71435546875\tLane Departure\t1\n38.94232097947902\t-91.73583984375\tSpeeding\t1\n41.69752591075902\t-91.593017578125\tSpeeding\t1\n34.88593094075317\t-91.73583984375\tSpeeding\t1\n36.659606226479696\t-95.1416015625\tUnsafe Follow Distance\t1\n38.97649248553942\t-92.384033203125\tSpeeding\t1\n39.75787999202175\t-92.735595703125\tLane Departure\t1\n40.763901280945866\t-88.76953125\tLane Departure\t1\n37.71859032558816\t-90.0\tUnsafe Tail Distance\t1\n39.78321267821705\t-93.131103515625\tUnsafe Tail Distance\t1\n39.715638134796336\t-90.966796875\tUnsafe Follow Distance\t1\n42.25291778330197\t-88.956298828125\tUnsafe Follow Distance\t1\n34.77771580360469\t-92.30712890625\tUnsafe Tail Distance\t1\n38.22091976683121\t-91.175537109375\tSpeeding\t1\n36.36822190085111\t-89.6484375\tUnsafe Tail Distance\t1\n37.80544394934273\t-92.30712890625\tUnsafe Follow Distance\t1\n41.85319643776675\t-89.285888671875\tUnsafe Follow Distance\t1\n38.97649248553942\t-93.197021484375\tUnsafe Follow Distance\t1\n41.11246878918085\t-88.41796875\tLane Departure\t1\n39.690280594818034\t-90.791015625\tLane Departure\t1\n37.7967631768216\t-92.48291015625\tUnsafe Tail Distance\t1\n38.30718056188315\t-91.065673828125\tSpeeding\t1\n39.7663252565449\t-94.15283203125\tSpeeding\t1\n34.813803317113155\t-91.93359375\tUnsafe Follow Distance\t1\n38.8225909761771\t-90.933837890625\tLane Departure\t1\n38.96795115401593\t-92.032470703125\tUnsafe Tail Distance\t1\n35.191766965947394\t-90.0439453125\tLane Departure\t1\n41.77950486590359\t-92.39501953125\tLane Departure\t1\n35.101934057246055\t-90.06591796875\tLane Departure\t1\n39.75787999202175\t-92.735595703125\tUnsafe Tail Distance\t1\n37.98750437106374\t-91.69189453125\tUnsafe Follow Distance\t1\n41.475660200278234\t-88.06640625\tUnsafe Follow Distance\t1\n37.09023980307208\t-94.229736328125\tUnsafe Tail Distance\t1\n41.590796851056005\t-90.19775390625\tUnsafe Tail Distance\t1\n37.19533058280065\t-89.560546875\tUnsafe Follow Distance\t1\n38.09133660751176\t-91.439208984375\tUnsafe Tail Distance\t1\n40.38002840251183\t-89.1650390625\tUnsafe Follow Distance\t1\n39.0959629363055\t-94.4384765625\tUnsafe Tail Distance\t1\n38.81403111409755\t-90.54931640625\tLane Departure\t1\n36.36822190085111\t-95.504150390625\tUnsafe Follow Distance\t1\n41.91862886518304\t-89.033203125\tSpeeding\t1\n39.01064750994083\t-93.84521484375\tLane Departure\t1\n36.84446074079564\t-94.833984375\tSpeeding\t1\n37.59682400108367\t-92.735595703125\tUnsafe Tail Distance\t1\n39.52946653645165\t-94.28466796875\tSpeeding\t1\n41.672911819602085\t-91.241455078125\tUnsafe Follow Distance\t1\n39.707186656826565\t-90.516357421875\tUnsafe Tail Distance\t1\n38.831149809348744\t-90.791015625\tUnsafe Follow Distance\t1\n38.95940879245423\t-92.21923828125\tSpeeding\t1\n39.75787999202175\t-90.142822265625\tSpeeding\t1\n38.50519140240356\t-90.52734375\tUnsafe Follow Distance\t1\n39.14710270770074\t-94.5703125\tUnsafe Follow Distance\t1\n41.62365539068639\t-90.703125\tLane Departure\t1\n37.25656608611523\t-93.14208984375\tUnsafe Tail Distance\t1\n41.86956082699455\t-87.6708984375\tUnsafe Tail Distance\t1\n37.65773212628274\t-94.295654296875\tSpeeding\t1\n38.94232097947902\t-91.73583984375\tUnsafe Follow Distance\t1\n35.02999636902565\t-90.94482421875\tUnsafe Follow Distance\t1\n42.22851735620852\t-91.77978515625\tLane Departure\t1\n37.34395908944491\t-92.98828125\tUnsafe Tail Distance\t1\n39.7663252565449\t-89.7802734375\tUnsafe Tail Distance\t1\n39.75787999202175\t-92.4169921875\tLane Departure\t1\n37.21283151445594\t-93.33984375\tSpeeding\t1\n41.713930073371294\t-93.043212890625\tSpeeding\t1\n41.72213058512578\t-91.6259765625\tLane Departure\t1\n38.61687046392973\t-90.15380859375\tUnsafe Tail Distance\t1\n39.27478966170308\t-94.41650390625\tUnsafe Tail Distance\t1\n37.93553306183642\t-91.988525390625\tUnsafe Tail Distance\t1\n38.46219172306828\t-90.85693359375\tLane Departure\t1\n38.66835610151509\t-94.383544921875\tUnsafe Follow Distance\t1\n38.30718056188315\t-91.065673828125\tUnsafe Follow Distance\t1\n40.697299008636755\t-89.5166015625\tSpeeding\t1\n38.99357205820946\t-93.44970703125\tUnsafe Tail Distance\t1\n38.496593518947556\t-90.692138671875\tUnsafe Tail Distance\t1\n40.96330795307353\t-90.28564453125\tLane Departure\t1\n37.71859032558816\t-90.0\tSpeeding\t1\n39.774769485295465\t-92.9443359375\tUnsafe Tail Distance\t1\n38.33303882235456\t-94.3505859375\tLane Departure\t1\n38.642617906345265\t-90.17578125\tUnsafe Tail Distance\t1\n39.774769485295465\t-93.603515625\tUnsafe Tail Distance\t1\n38.65119833229951\t-90.19775390625\tLane Departure\t1\n34.77771580360469\t-92.30712890625\tSpeeding\t1\n38.5825261593533\t-90.340576171875\tUnsafe Follow Distance\t1\n41.5579215778042\t-90.63720703125\tUnsafe Follow Distance\t1\n38.004819966413194\t-94.37255859375\tUnsafe Tail Distance\t1\n39.7663252565449\t-93.328857421875\tUnsafe Follow Distance\t1\n36.730079507078415\t-95.009765625\tSpeeding\t1\n39.75787999202175\t-92.4169921875\tUnsafe Tail Distance\t1\n37.70120736474139\t-92.61474609375\tUnsafe Tail Distance\t1\n37.7967631768216\t-92.48291015625\tSpeeding\t1\n40.863679665481676\t-89.912109375\tSpeeding\t1\n38.75408327579141\t-90.406494140625\tUnsafe Tail Distance\t1\n39.73253798438173\t-94.251708984375\tUnsafe Tail Distance\t1\n38.93377552819722\t-91.56005859375\tUnsafe Follow Distance\t1\n36.46547188679816\t-95.350341796875\tSpeeding\t1\n41.91862886518304\t-89.033203125\tUnsafe Follow Distance\t1\n36.182224980422525\t-95.7568359375\tUnsafe Tail Distance\t1\n37.814123701604466\t-92.076416015625\tLane Departure\t1\n35.94243575255426\t-89.80224609375\tUnsafe Tail Distance\t1\n41.75492216766298\t-92.735595703125\tUnsafe Follow Distance\t1\n37.02886944696474\t-94.581298828125\tUnsafe Tail Distance\t1\n39.04478604850143\t-94.163818359375\tUnsafe Tail Distance\t1\n41.590796851056005\t-90.19775390625\tSpeeding\t1\n34.95799531086792\t-91.142578125\tUnsafe Follow Distance\t1\n37.02009820136811\t-94.537353515625\tUnsafe Tail Distance\t1\n39.707186656826565\t-92.0654296875\tUnsafe Tail Distance\t1\n38.09133660751176\t-91.439208984375\tSpeeding\t1\n38.95940879245423\t-92.21923828125\tUnsafe Follow Distance\t1\n39.0959629363055\t-94.4384765625\tSpeeding\t1\n42.04113400940809\t-88.0224609375\tUnsafe Follow Distance\t1\n39.75787999202175\t-91.3623046875\tSpeeding\t1\n41.89409955811395\t-87.659912109375\tSpeeding\t1\n41.73852846935917\t-92.186279296875\tLane Departure\t1\n38.97649248553942\t-92.52685546875\tUnsafe Tail Distance\t1\n34.831841149828676\t-91.38427734375\tUnsafe Follow Distance\t1\n37.59682400108367\t-92.735595703125\tSpeeding\t1\n39.842286020743394\t-89.62646484375\tUnsafe Tail Distance\t1\n37.16031654673677\t-94.46044921875\tLane Departure\t1\n41.705728515237524\t-91.318359375\tSpeeding\t1\n36.25313319699069\t-95.69091796875\tUnsafe Follow Distance\t1\n39.0959629363055\t-94.59228515625\tUnsafe Follow Distance\t1\n37.16031654673677\t-93.69140625\tLane Departure\t1\n39.707186656826565\t-90.516357421875\tSpeeding\t1\n42.21224516288584\t-88.6376953125\tUnsafe Follow Distance\t1\n37.309014074275915\t-94.306640625\tUnsafe Tail Distance\t1\n37.996162679728116\t-90.24169921875\tUnsafe Tail Distance\t1\n39.75787999202175\t-93.93310546875\tUnsafe Follow Distance\t1\n39.04478604850143\t-94.306640625\tUnsafe Follow Distance\t1\n41.72213058512578\t-91.0546875\tUnsafe Follow Distance\t1\n40.763901280945866\t-88.76953125\tSpeeding\t1\n39.027718840211605\t-93.9990234375\tSpeeding\t1\n41.541477666790286\t-90.439453125\tLane Departure\t1\n35.35321610123821\t-90.24169921875\tLane Departure\t1\n41.65649719441145\t-90.823974609375\tUnsafe Follow Distance\t1\n41.86956082699455\t-87.6708984375\tSpeeding\t1\n41.7631174470059\t-89.6044921875\tLane Departure\t1\n41.73852846935917\t-92.186279296875\tUnsafe Tail Distance\t1\n39.690280594818034\t-90.791015625\tSpeeding\t1\n39.7663252565449\t-89.7802734375\tSpeeding\t1\n35.67514743608467\t-90.06591796875\tLane Departure\t1\n38.98503278695909\t-94.383544921875\tUnsafe Follow Distance\t1\n38.039438891821746\t-91.549072265625\tUnsafe Follow Distance\t1\n36.84446074079564\t-89.53857421875\tUnsafe Tail Distance\t1\n35.191766965947394\t-90.0439453125\tSpeeding\t1\n36.1733569352216\t-95.987548828125\tSpeeding\t1\n38.65119833229951\t-90.208740234375\tLane Departure\t1\n41.77131167976406\t-89.879150390625\tLane Departure\t1\n39.27478966170308\t-94.41650390625\tSpeeding\t1\n39.681826010893644\t-91.593017578125\tSpeeding\t1\n39.36827914916011\t-94.361572265625\tUnsafe Follow Distance\t1\n37.93553306183642\t-91.988525390625\tSpeeding\t1\n39.7663252565449\t-92.57080078125\tUnsafe Follow Distance\t1\n38.92522904714054\t-92.845458984375\tUnsafe Follow Distance\t1\n38.99357205820946\t-93.44970703125\tSpeeding\t1\n41.705728515237524\t-91.944580078125\tUnsafe Tail Distance\t1\n38.496593518947556\t-90.692138671875\tSpeeding\t1\n39.0959629363055\t-89.736328125\tUnsafe Tail Distance\t1\n39.7240885773337\t-90.24169921875\tSpeeding\t1\n38.004819966413194\t-94.37255859375\tSpeeding\t1\n41.672911819602085\t-91.241455078125\tLane Departure\t1\n42.114523952464246\t-88.406982421875\tUnsafe Tail Distance\t1\n35.11990857099681\t-90.68115234375\tUnsafe Follow Distance\t1\n39.00211029922512\t-93.6474609375\tLane Departure\t1\n39.73253798438173\t-94.251708984375\tSpeeding\t1\n36.659606226479696\t-95.1416015625\tUnsafe Tail Distance\t1\n41.77131167976406\t-89.879150390625\tUnsafe Tail Distance\t1\n39.715638134796336\t-90.966796875\tUnsafe Tail Distance\t1\n35.94243575255426\t-89.80224609375\tSpeeding\t1\n42.25291778330197\t-88.956298828125\tUnsafe Tail Distance\t1\n37.02886944696474\t-94.581298828125\tSpeeding\t1\n38.97649248553942\t-93.197021484375\tUnsafe Tail Distance\t1\n39.04478604850143\t-94.163818359375\tSpeeding\t1\n41.85319643776675\t-89.285888671875\tUnsafe Tail Distance\t1\n37.80544394934273\t-92.30712890625\tUnsafe Tail Distance\t1\n41.705728515237524\t-91.318359375\tUnsafe Follow Distance\t1\n41.62365539068639\t-93.58154296875\tLane Departure\t1\n35.02999636902565\t-90.94482421875\tLane Departure\t1\n39.707186656826565\t-92.0654296875\tSpeeding\t1\n34.813803317113155\t-91.93359375\tUnsafe Tail Distance\t1\n39.75787999202175\t-92.735595703125\tUnsafe Follow Distance\t1\n40.763901280945866\t-88.76953125\tUnsafe Follow Distance\t1\n38.97649248553942\t-92.52685546875\tSpeeding\t1\n39.842286020743394\t-89.62646484375\tSpeeding\t1\n38.8225909761771\t-90.670166015625\tSpeeding\t1\n41.11246878918085\t-88.41796875\tUnsafe Follow Distance\t1\n39.690280594818034\t-90.791015625\tUnsafe Follow Distance\t1\n37.996162679728116\t-90.24169921875\tSpeeding\t1\n40.38002840251183\t-89.1650390625\tUnsafe Tail Distance\t1\n36.36822190085111\t-95.504150390625\tUnsafe Tail Distance\t1\n38.33303882235456\t-94.3505859375\tSpeeding\t1\n38.8225909761771\t-90.933837890625\tUnsafe Follow Distance\t1\n39.740986355883564\t-89.9560546875\tSpeeding\t1\n38.14319750166766\t-91.29638671875\tUnsafe Tail Distance\t1\n35.191766965947394\t-90.0439453125\tUnsafe Follow Distance\t1\n41.77950486590359\t-92.39501953125\tUnsafe Follow Distance\t1\n35.101934057246055\t-90.06591796875\tUnsafe Follow Distance\t1\n38.831149809348744\t-90.791015625\tUnsafe Tail Distance\t1\n39.74943369178244\t-91.197509765625\tUnsafe Tail Distance\t1\n38.81403111409755\t-90.54931640625\tUnsafe Follow Distance\t1\n37.50972584293751\t-92.889404296875\tUnsafe Follow Distance\t1\n39.7663252565449\t-94.15283203125\tLane Departure\t1\n41.73852846935917\t-91.47216796875\tSpeeding\t1\n39.14710270770074\t-94.5703125\tUnsafe Tail Distance\t1\n38.94232097947902\t-91.73583984375\tUnsafe Tail Distance\t1\n41.69752591075902\t-91.593017578125\tUnsafe Tail Distance\t1\n35.20972164522138\t-90.37353515625\tSpeeding\t1\n38.95086540091999\t-92.625732421875\tSpeeding\t1\n38.22091976683121\t-91.175537109375\tUnsafe Tail Distance\t1\n39.0959629363055\t-89.736328125\tSpeeding\t1\n41.62365539068639\t-90.703125\tUnsafe Follow Distance\t1\n38.96795115401593\t-93.01025390625\tLane Departure\t1\n37.16031654673677\t-93.69140625\tSpeeding\t1\n38.30718056188315\t-91.065673828125\tUnsafe Tail Distance\t1\n38.831149809348744\t-91.1865234375\tLane Departure\t1\n37.16031654673677\t-94.46044921875\tSpeeding\t1\n39.774769485295465\t-93.603515625\tUnsafe Follow Distance\t1\n42.22851735620852\t-91.77978515625\tUnsafe Follow Distance\t1\n38.5825261593533\t-90.340576171875\tUnsafe Tail Distance\t1\n38.75408327579141\t-90.406494140625\tUnsafe Follow Distance\t1\n41.72213058512578\t-91.6259765625\tUnsafe Follow Distance\t1\n38.97649248553942\t-93.197021484375\tSpeeding\t1\n41.65649719441145\t-90.823974609375\tLane Departure\t1\n41.85319643776675\t-89.285888671875\tSpeeding\t1\n41.5579215778042\t-90.63720703125\tUnsafe Tail Distance\t1\n39.78321267821705\t-89.659423828125\tUnsafe Tail Distance\t1\n38.46219172306828\t-90.85693359375\tUnsafe Follow Distance\t1\n34.813803317113155\t-91.93359375\tSpeeding\t1\n37.65773212628274\t-94.295654296875\tLane Departure\t1\n38.33303882235456\t-94.3505859375\tUnsafe Follow Distance\t1\n40.96330795307353\t-90.28564453125\tUnsafe Follow Distance\t1\n41.91862886518304\t-89.033203125\tUnsafe Tail Distance\t1\n38.65119833229951\t-90.19775390625\tUnsafe Follow Distance\t1\n41.475660200278234\t-88.06640625\tSpeeding\t1\n39.52946653645165\t-94.28466796875\tUnsafe Tail Distance\t1\n37.98750437106374\t-91.69189453125\tSpeeding\t1\n37.21283151445594\t-93.33984375\tLane Departure\t1\n39.36827914916011\t-94.361572265625\tLane Departure\t1\n37.19533058280065\t-89.560546875\tSpeeding\t1\n34.95799531086792\t-91.142578125\tUnsafe Tail Distance\t1\n41.713930073371294\t-93.043212890625\tLane Departure\t1\n40.38002840251183\t-89.1650390625\tSpeeding\t1\n39.75787999202175\t-90.142822265625\tUnsafe Tail Distance\t1\n38.95940879245423\t-92.21923828125\tUnsafe Tail Distance\t1\n39.631076770083666\t-94.24072265625\tUnsafe Tail Distance\t1\n42.04113400940809\t-88.0224609375\tUnsafe Tail Distance\t1\n38.14319750166766\t-91.29638671875\tSpeeding\t1\n38.87392853923629\t-91.329345703125\tLane Departure\t1\n34.831841149828676\t-91.38427734375\tUnsafe Tail Distance\t1\n37.309014074275915\t-94.306640625\tUnsafe Follow Distance\t1\n37.814123701604466\t-92.076416015625\tUnsafe Follow Distance\t1\n39.0959629363055\t-94.59228515625\tUnsafe Tail Distance\t1\n41.672911819602085\t-91.241455078125\tSpeeding\t1\n36.25313319699069\t-95.69091796875\tUnsafe Tail Distance\t1\n37.71859032558816\t-90.0\tLane Departure\t1\n34.77771580360469\t-92.30712890625\tLane Departure\t1\n39.00211029922512\t-93.6474609375\tSpeeding\t1\n39.04478604850143\t-94.306640625\tUnsafe Tail Distance\t1\n36.36822190085111\t-89.6484375\tLane Departure\t1\n36.730079507078415\t-95.009765625\tLane Departure\t1\n41.72213058512578\t-91.0546875\tUnsafe Tail Distance\t1\n41.73852846935917\t-92.186279296875\tUnsafe Follow Distance\t1\n41.713930073371294\t-93.043212890625\tUnsafe Tail Distance\t1\n40.863679665481676\t-89.912109375\tLane Departure\t1\n38.50519140240356\t-90.52734375\tSpeeding\t1\n37.7967631768216\t-92.48291015625\tLane Departure\t1\n37.08147564886052\t-93.955078125\tUnsafe Follow Distance\t1\n37.16031654673677\t-94.46044921875\tUnsafe Follow Distance\t1\n38.96795115401593\t-92.032470703125\tLane Departure\t1\n37.16031654673677\t-93.69140625\tUnsafe Follow Distance\t1\n39.75787999202175\t-92.274169921875\tSpeeding\t1\n40.697299008636755\t-89.5166015625\tUnsafe Tail Distance\t1\n36.84446074079564\t-89.53857421875\tUnsafe Follow Distance\t1\n41.62365539068639\t-93.58154296875\tSpeeding\t1\n35.02999636902565\t-90.94482421875\tSpeeding\t1\n41.590796851056005\t-90.19775390625\tLane Departure\t1\n38.039438891821746\t-91.549072265625\tUnsafe Tail Distance\t1\n38.98503278695909\t-94.383544921875\tUnsafe Tail Distance\t1\n41.541477666790286\t-90.439453125\tUnsafe Follow Distance\t1\n39.0959629363055\t-94.4384765625\tLane Departure\t1\n38.92522904714054\t-92.845458984375\tUnsafe Tail Distance\t1\n40.863679665481676\t-89.912109375\tUnsafe Tail Distance\t1\n41.705728515237524\t-91.944580078125\tUnsafe Follow Distance\t1\n41.7631174470059\t-89.6044921875\tUnsafe Follow Distance\t1\n35.35321610123821\t-90.24169921875\tUnsafe Follow Distance\t1\n38.66835610151509\t-94.383544921875\tSpeeding\t1\n39.7663252565449\t-92.57080078125\tUnsafe Tail Distance\t1\n39.707186656826565\t-90.516357421875\tLane Departure\t1\n35.67514743608467\t-90.06591796875\tUnsafe Follow Distance\t1\n37.59682400108367\t-92.735595703125\tLane Departure\t1\n38.42777351132905\t-90.3515625\tLane Departure\t1\n39.7663252565449\t-93.328857421875\tSpeeding\t1\n41.77131167976406\t-89.879150390625\tUnsafe Follow Distance\t1\n41.5579215778042\t-90.63720703125\tSpeeding\t1\n39.027718840211605\t-93.9990234375\tLane Departure\t1\n35.11990857099681\t-90.68115234375\tUnsafe Tail Distance\t1\n37.25656608611523\t-93.14208984375\tLane Departure\t1\n38.93377552819722\t-91.56005859375\tSpeeding\t1\n39.75787999202175\t-91.3623046875\tUnsafe Tail Distance\t1\n41.86956082699455\t-87.6708984375\tLane Departure\t1\n41.89409955811395\t-87.659912109375\tUnsafe Tail Distance\t1\n37.34395908944491\t-92.98828125\tLane Departure\t1\n39.7663252565449\t-89.7802734375\tLane Departure\t1\n41.75492216766298\t-92.735595703125\tSpeeding\t1\n39.69873414348139\t-90.626220703125\tUnsafe Follow Distance\t1\n41.705728515237524\t-91.318359375\tUnsafe Tail Distance\t1\n37.47485808497102\t-89.71435546875\tUnsafe Tail Distance\t1\n34.95799531086792\t-91.142578125\tSpeeding\t1\n39.00211029922512\t-93.6474609375\tUnsafe Follow Distance\t1\n39.27478966170308\t-94.41650390625\tLane Departure\t1\n39.681826010893644\t-91.593017578125\tLane Departure\t1\n39.027718840211605\t-93.9990234375\tUnsafe Tail Distance\t1\n40.763901280945866\t-88.76953125\tUnsafe Tail Distance\t1\n42.04113400940809\t-88.0224609375\tSpeeding\t1\n38.99357205820946\t-93.44970703125\tLane Departure\t1\n34.831841149828676\t-91.38427734375\tSpeeding\t1\n39.0959629363055\t-94.59228515625\tSpeeding\t1\n38.496593518947556\t-90.692138671875\tLane Departure\t1\n38.96795115401593\t-93.01025390625\tSpeeding\t1\n39.774769485295465\t-92.9443359375\tLane Departure\t1\n39.774769485295465\t-93.603515625\tLane Departure\t1\n41.11246878918085\t-88.41796875\tUnsafe Tail Distance\t1\n39.75787999202175\t-93.93310546875\tSpeeding\t1\n39.7240885773337\t-90.24169921875\tLane Departure\t1\n38.831149809348744\t-91.1865234375\tSpeeding\t1\n41.62365539068639\t-93.58154296875\tUnsafe Follow Distance\t1\n42.21224516288584\t-88.6376953125\tSpeeding\t1\n41.72213058512578\t-91.0546875\tSpeeding\t1\n38.831149809348744\t-91.0986328125\tLane Departure\t1\n38.004819966413194\t-94.37255859375\tLane Departure\t1\n37.70120736474139\t-92.61474609375\tLane Departure\t1\n35.191766965947394\t-90.0439453125\tUnsafe Tail Distance\t1\n39.73253798438173\t-94.251708984375\tLane Departure\t1\n38.75408327579141\t-90.406494140625\tLane Departure\t1\n36.1733569352216\t-95.987548828125\tUnsafe Tail Distance\t1\n41.77950486590359\t-92.39501953125\tUnsafe Tail Distance\t1\n35.101934057246055\t-90.06591796875\tUnsafe Tail Distance\t1\n36.182224980422525\t-95.7568359375\tLane Departure\t1\n41.65649719441145\t-90.823974609375\tSpeeding\t1\n35.94243575255426\t-89.80224609375\tLane Departure\t1\n38.81403111409755\t-90.54931640625\tUnsafe Tail Distance\t1\n37.02886944696474\t-94.581298828125\tLane Departure\t1\n34.795761534730325\t-92.08740234375\tLane Departure\t1\n41.69752591075902\t-91.593017578125\tUnsafe Follow Distance\t1\n38.98503278695909\t-94.383544921875\tSpeeding\t1\n37.50972584293751\t-92.889404296875\tUnsafe Tail Distance\t1\n38.039438891821746\t-91.549072265625\tSpeeding\t1\n37.02009820136811\t-94.537353515625\tLane Departure\t1\n39.707186656826565\t-92.0654296875\tLane Departure\t1\n39.01064750994083\t-93.84521484375\tUnsafe Tail Distance\t1\n38.97649248553942\t-92.384033203125\tUnsafe Follow Distance\t1\n38.92522904714054\t-92.845458984375\tSpeeding\t1\n39.7663252565449\t-92.57080078125\tSpeeding\t1\n39.842286020743394\t-89.62646484375\tLane Departure\t1\n37.996162679728116\t-90.24169921875\tLane Departure\t1\n37.309014074275915\t-94.306640625\tLane Departure\t1\n39.7663252565449\t-94.15283203125\tUnsafe Follow Distance\t1\n41.62365539068639\t-90.703125\tUnsafe Tail Distance\t1\n38.87392853923629\t-91.329345703125\tSpeeding\t1\n39.78321267821705\t-93.131103515625\tSpeeding\t1\n39.740986355883564\t-89.9560546875\tLane Departure\t1\n35.11990857099681\t-90.68115234375\tSpeeding\t1\n42.22851735620852\t-91.77978515625\tUnsafe Tail Distance\t1\n36.36822190085111\t-89.6484375\tSpeeding\t1\n41.72213058512578\t-91.6259765625\tUnsafe Tail Distance\t1\n38.96795115401593\t-93.01025390625\tUnsafe Follow Distance\t1\n37.47485808497102\t-89.71435546875\tSpeeding\t1\n36.84446074079564\t-89.53857421875\tLane Departure\t1\n38.96795115401593\t-92.032470703125\tSpeeding\t1\n41.73852846935917\t-91.47216796875\tLane Departure\t1\n38.33303882235456\t-94.3505859375\tUnsafe Tail Distance\t1\n36.84446074079564\t-94.833984375\tUnsafe Follow Distance\t1\n40.96330795307353\t-90.28564453125\tUnsafe Tail Distance\t1\n39.52946653645165\t-94.28466796875\tUnsafe Follow Distance\t1\n38.95086540091999\t-92.625732421875\tLane Departure\t1\n38.65119833229951\t-90.19775390625\tUnsafe Tail Distance\t1\n35.20972164522138\t-90.37353515625\tLane Departure\t1\n41.68932225997044\t-93.36181640625\tLane Departure\t1\n39.75787999202175\t-90.142822265625\tUnsafe Follow Distance\t1\n41.705728515237524\t-91.944580078125\tLane Departure\t1\n39.0959629363055\t-89.736328125\tLane Departure\t1\n41.11246878918085\t-88.41796875\tSpeeding\t1\n37.65773212628274\t-94.295654296875\tUnsafe Follow Distance\t1\n38.8225909761771\t-90.933837890625\tSpeeding\t1\n41.73852846935917\t-91.47216796875\tUnsafe Tail Distance\t1\n35.101934057246055\t-90.06591796875\tSpeeding\t1\n36.659606226479696\t-95.1416015625\tLane Departure\t1\n41.77950486590359\t-92.39501953125\tSpeeding\t1\n37.814123701604466\t-92.076416015625\tUnsafe Tail Distance\t1\n38.95086540091999\t-92.625732421875\tUnsafe Tail Distance\t1\n42.25291778330197\t-88.956298828125\tLane Departure\t1\n35.20972164522138\t-90.37353515625\tUnsafe Tail Distance\t1\n41.713930073371294\t-93.043212890625\tUnsafe Follow Distance\t1\n38.97649248553942\t-93.197021484375\tLane Departure\t1\n41.85319643776675\t-89.285888671875\tLane Departure\t1\n37.80544394934273\t-92.30712890625\tLane Departure\t1\n38.81403111409755\t-90.54931640625\tSpeeding\t1\n37.50972584293751\t-92.889404296875\tSpeeding\t1\n37.08147564886052\t-93.955078125\tUnsafe Tail Distance\t1\n34.813803317113155\t-91.93359375\tLane Departure\t1\n40.697299008636755\t-89.5166015625\tUnsafe Follow Distance\t1\n38.87392853923629\t-91.329345703125\tUnsafe Follow Distance\t1\n39.01064750994083\t-93.84521484375\tSpeeding\t1\n37.16031654673677\t-94.46044921875\tUnsafe Tail Distance\t1\n39.78321267821705\t-93.131103515625\tUnsafe Follow Distance\t1\n37.16031654673677\t-93.69140625\tUnsafe Tail Distance\t1\n37.71859032558816\t-90.0\tUnsafe Follow Distance\t1\n38.61687046392973\t-90.15380859375\tSpeeding\t1\n34.77771580360469\t-92.30712890625\tUnsafe Follow Distance\t1\n41.475660200278234\t-88.06640625\tLane Departure\t1\n36.36822190085111\t-89.6484375\tUnsafe Follow Distance\t1\n37.98750437106374\t-91.69189453125\tLane Departure\t1\n36.730079507078415\t-95.009765625\tUnsafe Follow Distance\t1\n37.7967631768216\t-92.48291015625\tUnsafe Follow Distance\t1\n37.19533058280065\t-89.560546875\tLane Departure\t1\n41.541477666790286\t-90.439453125\tUnsafe Tail Distance\t1\n40.863679665481676\t-89.912109375\tUnsafe Follow Distance\t1\n40.38002840251183\t-89.1650390625\tLane Departure\t1\n41.62365539068639\t-90.703125\tSpeeding\t1\n38.642617906345265\t-90.17578125\tSpeeding\t1\n38.14319750166766\t-91.29638671875\tLane Departure\t1\n41.7631174470059\t-89.6044921875\tUnsafe Tail Distance\t1\n38.96795115401593\t-92.032470703125\tUnsafe Follow Distance\t1\n39.707186656826565\t-90.37353515625\tUnsafe Tail Distance\t1\n35.35321610123821\t-90.24169921875\tUnsafe Tail Distance\t1\n39.774769485295465\t-92.9443359375\tSpeeding\t1\n41.590796851056005\t-90.19775390625\tUnsafe Follow Distance\t1\n35.67514743608467\t-90.06591796875\tUnsafe Tail Distance\t1\n42.22851735620852\t-91.77978515625\tSpeeding\t1\n39.75787999202175\t-92.4169921875\tSpeeding\t1\n41.72213058512578\t-91.6259765625\tSpeeding\t1\n38.75408327579141\t-90.406494140625\tSpeeding\t1\n38.831149809348744\t-90.791015625\tLane Departure\t1\n39.74943369178244\t-91.197509765625\tLane Departure\t1\n39.0959629363055\t-94.4384765625\tUnsafe Follow Distance\t1\n41.475660200278234\t-88.06640625\tUnsafe Tail Distance\t1\n38.65119833229951\t-90.208740234375\tUnsafe Tail Distance\t1\n38.50519140240356\t-90.52734375\tLane Departure\t1\n38.46219172306828\t-90.85693359375\tSpeeding\t1\n37.19533058280065\t-89.560546875\tUnsafe Tail Distance\t1\n41.89409955811395\t-87.659912109375\tUnsafe Follow Distance\t1\n39.75787999202175\t-91.3623046875\tUnsafe Follow Distance\t1\n39.14710270770074\t-94.5703125\tLane Departure\t1\n41.69752591075902\t-91.593017578125\tLane Departure\t1\n34.795761534730325\t-92.08740234375\tSpeeding\t1\n40.96330795307353\t-90.28564453125\tSpeeding\t1\n39.75787999202175\t-92.274169921875\tLane Departure\t1\n37.59682400108367\t-92.735595703125\tUnsafe Follow Distance\t1\n38.65119833229951\t-90.19775390625\tSpeeding\t1\n41.672911819602085\t-91.241455078125\tUnsafe Tail Distance\t1\n39.69873414348139\t-90.626220703125\tUnsafe Tail Distance\t1\n38.42777351132905\t-90.3515625\tUnsafe Follow Distance\t1\n39.00211029922512\t-93.6474609375\tUnsafe Tail Distance\t1\n38.22091976683121\t-91.175537109375\tLane Departure\t1\n39.027718840211605\t-93.9990234375\tUnsafe Follow Distance\t1\n37.25656608611523\t-93.14208984375\tUnsafe Follow Distance\t1\n41.86956082699455\t-87.6708984375\tUnsafe Follow Distance\t1\n38.66835610151509\t-94.383544921875\tLane Departure\t1\n37.309014074275915\t-94.306640625\tSpeeding\t1\n39.7663252565449\t-89.7802734375\tUnsafe Follow Distance\t1\n37.34395908944491\t-92.98828125\tUnsafe Follow Distance\t1\n39.75787999202175\t-92.274169921875\tUnsafe Tail Distance\t1\n38.61687046392973\t-90.15380859375\tUnsafe Follow Distance\t1\n35.02999636902565\t-90.94482421875\tUnsafe Tail Distance\t1\n41.62365539068639\t-93.58154296875\tUnsafe Tail Distance\t1\n36.1733569352216\t-95.987548828125\tUnsafe Follow Distance\t1\n39.681826010893644\t-91.593017578125\tUnsafe Follow Distance\t1\n39.27478966170308\t-94.41650390625\tUnsafe Follow Distance\t1\n41.5579215778042\t-90.63720703125\tLane Departure\t1\n39.7663252565449\t-93.328857421875\tLane Departure\t1\n37.93553306183642\t-91.988525390625\tUnsafe Follow Distance\t1\n41.73852846935917\t-92.186279296875\tSpeeding\t1\n38.99357205820946\t-93.44970703125\tUnsafe Follow Distance\t1\n38.93377552819722\t-91.56005859375\tLane Departure\t1\n37.08147564886052\t-93.955078125\tSpeeding\t1\n41.91862886518304\t-89.033203125\tLane Departure\t1\n38.66835610151509\t-94.383544921875\tUnsafe Tail Distance\t1\n38.496593518947556\t-90.692138671875\tUnsafe Follow Distance\t1\n36.84446074079564\t-89.53857421875\tSpeeding\t1\n39.7240885773337\t-90.24169921875\tUnsafe Follow Distance\t1\n37.70120736474139\t-92.61474609375\tUnsafe Follow Distance\t1\n38.831149809348744\t-91.0986328125\tUnsafe Follow Distance\t1\n41.75492216766298\t-92.735595703125\tLane Departure\t1\n38.004819966413194\t-94.37255859375\tUnsafe Follow Distance\t1\n41.541477666790286\t-90.439453125\tSpeeding\t1\n34.95799531086792\t-91.142578125\tLane Departure\t1\n38.95940879245423\t-92.21923828125\tLane Departure\t1\n39.631076770083666\t-94.24072265625\tLane Departure\t1\n34.88593094075317\t-91.73583984375\tUnsafe Tail Distance\t1\n35.35321610123821\t-90.24169921875\tSpeeding\t1\n42.04113400940809\t-88.0224609375\tLane Departure\t1\n41.68932225997044\t-93.36181640625\tSpeeding\t1\n36.182224980422525\t-95.7568359375\tUnsafe Follow Distance\t1\n41.7631174470059\t-89.6044921875\tSpeeding\t1\n35.94243575255426\t-89.80224609375\tUnsafe Follow Distance\t1\n34.831841149828676\t-91.38427734375\tLane Departure\t1\n39.04478604850143\t-94.163818359375\tUnsafe Follow Distance\t1\n35.67514743608467\t-90.06591796875\tSpeeding\t1\n34.795761534730325\t-92.08740234375\tUnsafe Follow Distance\t1\n39.0959629363055\t-94.59228515625\tLane Departure\t1\n42.114523952464246\t-88.406982421875\tSpeeding\t1\n37.02886944696474\t-94.581298828125\tUnsafe Follow Distance\t1\n39.7663252565449\t-94.15283203125\tUnsafe Tail Distance\t1\n39.75787999202175\t-93.93310546875\tLane Departure\t1\n39.707186656826565\t-92.0654296875\tUnsafe Follow Distance\t1\n41.77131167976406\t-89.879150390625\tSpeeding\t1\n39.04478604850143\t-94.306640625\tLane Departure\t1\n41.72213058512578\t-91.0546875\tLane Departure\t1\n41.75492216766298\t-92.735595703125\tUnsafe Tail Distance\t1\n42.25291778330197\t-88.956298828125\tSpeeding\t1\n38.97649248553942\t-92.52685546875\tUnsafe Follow Distance\t1\n39.842286020743394\t-89.62646484375\tUnsafe Follow Distance\t1\n38.8225909761771\t-90.670166015625\tUnsafe Follow Distance\t1\n37.996162679728116\t-90.24169921875\tUnsafe Follow Distance\t1\n40.697299008636755\t-89.5166015625\tLane Departure\t1\n"}]},"apps":[],"jobName":"paragraph_1490307733035_-1044169036","id":"20170217-000658_1097661392","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:383"},{"text":"%md\n\n## Done with data analysis, let's build a regression model to predict violations","dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Done with data analysis, let's build a regression model to predict violations</h2>\n"}]},"apps":[],"jobName":"paragraph_1490307733036_-1046092780","id":"20170217-000729_2110930641","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:384"},{"text":"import org.apache.spark.mllib.util.MLUtils;\nimport org.apache.spark.mllib.optimization;\nimport org.apache.spark.ml.classification.LogisticRegression;\nimport org.apache.spark.mllib.classification.LogisticRegressionWithSGD;\nimport org.apache.spark.mllib.optimization.SquaredL2Updater;\nimport org.apache.spark.mllib.evaluation.BinaryClassificationMetrics;\n\n//We need to convert our data to LabeledPoints for training a Logistic Regression model\n// TruckData(eventTime: Long, truckId: Int, driverId: Int, driverName: String,\n//                                       routeId: Int, routeName: String, latitude: Double, longitude: Double,\n//                                       speed: Int, eventType: String, foggy: Int, rainy: Int, windy: Int, congestionLevel: Int, isViolation: Int)\n\ntruckRDD.take(1).foreach(a => println(a))\n\nval labeledPoints = truckRDD.map{\n    truck =>\n    LabeledPoint(truck.isViolation.toDouble, Vectors.dense(truck.routeId, truck.latitude, truck.longitude, truck.speed, truck.foggy, truck.rainy, truck.windy))\n}\n\n//Create a small random sample for training. This can be useful for quickly iterating over model designs\nval sample = labeledPoints.sample(false, 1, System.currentTimeMillis().toInt).cache()\nprintln(sample.count())\n\nval splits = sample.randomSplit(Array(0.8, 0.2))\nval training = splits(0).cache()\nval test = splits(1).cache()\n\nval numTraining = training.count()\nval numTest = test.count()\nprintln(s\"Training: $numTraining, test: $numTest.\")\n    \nval updater = new SquaredL2Updater()\n    \n    val model = {\n        // val algorithm = new LogisticRegression()\n        // algorithm.fit(training.toDF())\n        val algorithm = new LogisticRegressionWithSGD()\n        algorithm.optimizer.setNumIterations(200).setStepSize(1.0).setUpdater(updater).setRegParam(0.1)\n        algorithm.run(training).clearThreshold()\n     }   \n        \n    val rprediction = model.predict(test.map(_.features))\n    val rpredictionAndLabel = rprediction.zip(test.map(_.label))\n    val rmetrics = new BinaryClassificationMetrics(rpredictionAndLabel)\n\n    println(\"\\n\");\n    println(\"Route Id Weight \" + model.weights(0))\n    println(\"Latitude Weight \" + model.weights(1))\n    println(\"Longitude Weight \" + model.weights(2))\n    println(\"Speed Weight \" + model.weights(3))\n    println(\"Foggy Weight \" + model.weights(4))\n    println(\"Rainy Weight \" + model.weights(5))\n    println(\"Windy Weight \" + model.weights(6))\n    println(\"\\n\")\n    println(\"Intercept \" + model.intercept)\n    println(s\"Test areaUnderPR = ${rmetrics.areaUnderPR()}.\")\n    println(s\"Test areaUnderROC = ${rmetrics.areaUnderROC()}.\")\n    \n    \nval valuesAndPreds = test.map { point =>\n  val prediction = model.predict(point.features)\n  (point.label, prediction, point.features)\n}\n\nval MSE = valuesAndPreds.map{ case(label, prediction, features) => math.pow((label - prediction), 2) }.mean()\nprintln(\"training Mean Squared Error = \" + MSE)\nprintln(\"intercept: \" + model.intercept + \" weights: \" + model.weights)\n\nvaluesAndPreds.take(100).foreach(println)\n\n// Save and load model\nmodel.save(sc, \"hdfs:///tmp/trucking/models/scalaLinearRegressionWithSGDModel\")\n\n//model.save(sc, \"file:///tmp/trucking/models/scalaLinearRegressionWithSGDModel\")\n//val sameModel = LinearRegressionModel.load(sc, \"/tmp/trucking/models/scalaLinearRegressionWithSGDModel\")","dateUpdated":"2017-03-23T22:43:55+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.mllib.util.MLUtils\n\nimport org.apache.spark.mllib.optimization\n\nimport org.apache.spark.ml.classification.LogisticRegression\n\nimport org.apache.spark.mllib.classification.LogisticRegressionWithSGD\n\nimport org.apache.spark.mllib.optimization.SquaredL2Updater\n\nimport org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\nTruckData(1486669632837,30,1,Edgar Orendain,101,Joplin to Kansas City,37.16031654673677,-94.46044921875,79,Normal,0,0,0,52,0)\n\nlabeledPoints: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[14] at map at <console>:47\n\nsample: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = PartitionwiseSampledRDD[15] at sample at <console>:49\n12877\n\nsplits: Array[org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint]] = Array(MapPartitionsRDD[16] at randomSplit at <console>:51, MapPartitionsRDD[17] at randomSplit at <console>:51)\n\ntraining: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[16] at randomSplit at <console>:51\n\ntest: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[17] at randomSplit at <console>:51\n\nnumTraining: Long = 10372\n\nnumTest: Long = 2505\nTraining: 10372, test: 2505.\n\nupdater: org.apache.spark.mllib.optimization.SquaredL2Updater = org.apache.spark.mllib.optimization.SquaredL2Updater@505397db\n\nmodel: org.apache.spark.mllib.classification.LogisticRegressionModel = org.apache.spark.mllib.classification.LogisticRegressionModel: intercept = 0.0, numFeatures = 7, numClasses = 2, threshold = None\n\nrprediction: org.apache.spark.rdd.RDD[Double] = MapPartitionsRDD[422] at mapPartitions at GeneralizedLinearAlgorithm.scala:69\n\nrpredictionAndLabel: org.apache.spark.rdd.RDD[(Double, Double)] = ZippedPartitionsRDD2[424] at zip at <console>:63\n\nrmetrics: org.apache.spark.mllib.evaluation.BinaryClassificationMetrics = org.apache.spark.mllib.evaluation.BinaryClassificationMetrics@3e2c3a45\n\n\nRoute Id Weight -1.2885704147274335\nLatitude Weight -0.04483626596691881\nLongitude Weight 1.214715265371117\nSpeed Weight 3.6840618538048724\nFoggy Weight 0.8391241052668234\nRainy Weight 0.8391241052668234\nWindy Weight 0.2504797172962078\n\n\nIntercept 0.0\nTest areaUnderPR = 0.37697287998806905.\nTest areaUnderROC = 0.6611696032885422.\n\nvaluesAndPreds: org.apache.spark.rdd.RDD[(Double, Double, org.apache.spark.mllib.linalg.Vector)] = MapPartitionsRDD[444] at map at <console>:61\n\nMSE: Double = 0.338510186529048\ntraining Mean Squared Error = 0.338510186529048\nintercept: 0.0 weights: [-1.2885704147274335,-0.04483626596691881,1.214715265371117,3.6840618538048724,0.8391241052668234,0.8391241052668234,0.2504797172962078]\n(0.0,1.0,[101.0,38.33303882235456,-94.3505859375,79.0,0.0,0.0,0.0])\n(0.0,2.2447740579659127E-29,[101.0,38.004819966413194,-94.37255859375,49.0,0.0,0.0,0.0])\n(0.0,1.7171722022469104E-16,[101.0,38.98503278695909,-94.383544921875,57.0,0.0,0.0,1.0])\n(0.0,2.595783158316845E-42,[101.0,39.0959629363055,-94.59228515625,41.0,0.0,0.0,0.0])\n(0.0,5.276431330170227E-7,[101.0,39.0959629363055,-94.59228515625,63.0,0.0,0.0,1.0])\n(0.0,4.312059905384637E-10,[101.0,38.98503278695909,-94.383544921875,61.0,0.0,0.0,1.0])\n(0.0,6.300384302899762E-23,[101.0,37.309014074275915,-94.306640625,53.0,0.0,0.0,0.0])\n(1.0,0.8833969026976194,[101.0,38.004819966413194,-94.37255859375,67.0,1.0,1.0,0.0])\n(0.0,0.9999999998244498,[101.0,38.33303882235456,-94.3505859375,73.0,0.0,0.0,0.0])\n(0.0,2.096879148755524E-45,[101.0,37.16031654673677,-94.46044921875,39.0,0.0,0.0,0.0])\n(0.0,2.8839801318203955E-26,[101.0,37.02886944696474,-94.581298828125,51.0,0.0,0.0,0.0])\n(0.0,1.6356396283712838E-13,[101.0,39.0959629363055,-94.59228515625,59.0,0.0,0.0,0.0])\n(0.0,5.327011238726713E-39,[101.0,38.98503278695909,-94.383544921875,43.0,0.0,0.0,0.0])\n(0.0,3.3228357115294056E-42,[101.0,37.16031654673677,-94.46044921875,41.0,0.0,0.0,0.0])\n(0.0,3.3616163305681774E-42,[101.0,38.98503278695909,-94.383544921875,41.0,0.0,0.0,0.0])\n(0.0,2.510838408344983E-45,[101.0,37.309014074275915,-94.306640625,39.0,0.0,0.0,0.0])\n(0.0,2.510838408344983E-45,[101.0,37.309014074275915,-94.306640625,39.0,0.0,0.0,0.0])\n(0.0,8.767266745669391E-29,[101.0,39.0959629363055,-94.59228515625,49.0,1.0,1.0,0.0])\n(0.0,1.4176199800187766E-48,[101.0,38.004819966413194,-94.37255859375,37.0,0.0,0.0,0.0])\n(0.0,0.9999999999929585,[104.0,41.11246878918085,-88.41796875,73.0,0.0,0.0,0.0])\n(0.0,1.0,[104.0,41.475660200278234,-88.06640625,79.0,0.0,0.0,1.0])\n(0.0,1.0,[104.0,41.11246878918085,-88.41796875,79.0,0.0,0.0,0.0])\n(1.0,1.0,[104.0,38.65119833229951,-90.19775390625,81.0,1.0,1.0,0.0])\n(1.0,1.0,[104.0,40.38002840251183,-89.1650390625,77.0,0.0,0.0,1.0])\n(1.0,1.0,[104.0,39.0959629363055,-89.736328125,79.0,1.0,1.0,0.0])\n(0.0,2.2538154657455418E-18,[104.0,41.11246878918085,-88.41796875,55.0,0.0,0.0,0.0])\n(0.0,0.9999999989246016,[104.0,41.475660200278234,-88.06640625,71.0,1.0,1.0,1.0])\n(0.0,0.9999999732423315,[104.0,40.38002840251183,-89.1650390625,71.0,0.0,0.0,0.0])\n(0.0,0.9999999542490908,[104.0,39.842286020743394,-89.62646484375,71.0,0.0,0.0,0.0])\n(0.0,1.0,[104.0,41.86956082699455,-87.6708984375,88.0,0.0,0.0,0.0])\n(1.0,1.0,[104.0,40.763901280945866,-88.76953125,90.0,1.0,1.0,0.0])\n(0.0,1.0,[104.0,38.65119833229951,-90.19775390625,100.0,0.0,0.0,1.0])\n(0.0,0.9999862359756838,[104.0,41.11246878918085,-88.41796875,69.0,0.0,0.0,1.0])\n(0.0,0.9999999979167378,[104.0,41.11246878918085,-88.41796875,71.0,1.0,1.0,0.0])\n(0.0,0.9999999868933014,[104.0,40.763901280945866,-88.76953125,71.0,0.0,0.0,1.0])\n(0.0,1.0,[104.0,40.763901280945866,-88.76953125,77.0,0.0,0.0,0.0])\n(0.0,1.0,[104.0,41.86956082699455,-87.6708984375,81.0,0.0,0.0,0.0])\n(0.0,1.0,[104.0,39.0959629363055,-89.736328125,79.0,0.0,0.0,0.0])\n(1.0,1.0,[104.0,38.65119833229951,-90.19775390625,81.0,1.0,1.0,0.0])\n(1.0,1.0,[104.0,40.763901280945866,-88.76953125,79.0,1.0,1.0,1.0])\n(1.0,1.0,[104.0,40.763901280945866,-88.76953125,89.0,1.0,1.0,1.0])\n(1.0,9.778081570187818E-5,[104.0,41.11246878918085,-88.41796875,63.0,1.0,1.0,1.0])\n(0.0,9.39870406799056E-19,[104.0,40.38002840251183,-89.1650390625,55.0,0.0,0.0,0.0])\n(0.0,2.36688111025256E-15,[104.0,40.763901280945866,-88.76953125,57.0,0.0,0.0,0.0])\n(0.0,1.0990213790842972E-14,[104.0,41.86956082699455,-87.6708984375,57.0,0.0,0.0,1.0])\n(0.0,3.1364025404915197E-6,[104.0,39.0959629363055,-89.736328125,63.0,0.0,0.0,0.0])\n(0.0,0.005462794732535256,[104.0,39.842286020743394,-89.62646484375,65.0,0.0,0.0,0.0])\n(0.0,0.9999733191808112,[104.0,40.763901280945866,-88.76953125,69.0,0.0,0.0,0.0])\n(1.0,0.999992083624755,[104.0,40.38002840251183,-89.1650390625,69.0,1.0,1.0,0.0])\n(1.0,0.9179102479522394,[104.0,39.842286020743394,-89.62646484375,67.0,0.0,0.0,1.0])\n(0.0,0.005462794732535256,[104.0,39.842286020743394,-89.62646484375,65.0,0.0,0.0,0.0])\n(1.0,0.09313187565466409,[104.0,40.763901280945866,-88.76953125,65.0,1.0,1.0,1.0])\n(0.0,1.8257203546474294E-5,[104.0,41.11246878918085,-88.41796875,63.0,0.0,0.0,1.0])\n(0.0,1.250856647062063E-44,[104.0,39.0959629363055,-89.736328125,39.0,0.0,0.0,0.0])\n(0.0,3.745585352899446E-41,[104.0,40.38002840251183,-89.1650390625,41.0,0.0,0.0,0.0])\n(1.0,0.9999998724444826,[107.0,38.94232097947902,-91.73583984375,72.0,1.0,1.0,0.0])\n(1.0,0.9999999989531543,[107.0,39.01064750994083,-93.84521484375,74.0,1.0,1.0,0.0])\n(0.0,0.9999984962744212,[107.0,38.97649248553942,-92.384033203125,72.0,0.0,0.0,0.0])\n(0.0,1.0,[107.0,38.8225909761771,-90.670166015625,80.0,0.0,0.0,0.0])\n(0.0,1.0,[107.0,38.81403111409755,-90.54931640625,78.0,0.0,0.0,0.0])\n(0.0,1.0,[107.0,38.831149809348744,-90.791015625,80.0,0.0,0.0,1.0])\n(0.0,1.0,[107.0,38.87392853923629,-91.329345703125,82.0,0.0,0.0,0.0])\n(0.0,1.0,[107.0,38.94232097947902,-91.73583984375,81.0,0.0,0.0,0.0])\n(0.0,1.0,[107.0,38.95940879245423,-92.21923828125,79.0,0.0,0.0,1.0])\n(0.0,1.0,[107.0,39.00211029922512,-93.6474609375,87.0,0.0,0.0,1.0])\n(0.0,1.0,[107.0,39.04478604850143,-94.163818359375,93.0,1.0,1.0,0.0])\n(0.0,1.0,[107.0,38.99357205820946,-93.44970703125,81.0,0.0,0.0,0.0])\n(0.0,1.0,[107.0,38.81403111409755,-90.54931640625,83.0,0.0,0.0,0.0])\n(1.0,0.9999999935558939,[107.0,38.8225909761771,-90.933837890625,73.0,0.0,0.0,0.0])\n(1.0,0.9999999983640193,[107.0,38.831149809348744,-91.1865234375,73.0,1.0,1.0,0.0])\n(0.0,1.0,[107.0,39.04478604850143,-94.306640625,81.0,0.0,0.0,0.0])\n(0.0,1.8082893013565378E-44,[107.0,38.97649248553942,-92.52685546875,41.0,0.0,0.0,1.0])\n(0.0,0.9999999999999953,[107.0,39.0959629363055,-94.4384765625,78.0,0.0,0.0,0.0])\n(0.0,0.9999999999999978,[107.0,39.01064750994083,-93.84521484375,78.0,0.0,0.0,0.0])\n(0.0,0.999999999999861,[107.0,38.831149809348744,-91.1865234375,76.0,0.0,0.0,0.0])\n(0.0,0.9999998392645723,[107.0,38.81403111409755,-90.54931640625,72.0,0.0,0.0,0.0])\n(0.0,0.9999999998381193,[107.0,38.8225909761771,-90.933837890625,74.0,0.0,0.0,0.0])\n(1.0,0.9999999999999964,[107.0,39.0959629363055,-94.4384765625,78.0,0.0,0.0,1.0])\n(1.0,0.9999999999990978,[107.0,39.04478604850143,-94.306640625,76.0,1.0,1.0,1.0])\n(0.0,0.9999999999998344,[107.0,38.87392853923629,-91.329345703125,76.0,0.0,0.0,0.0])\n(1.0,1.0,[107.0,39.0959629363055,-94.4384765625,93.0,0.0,0.0,0.0])\n(0.0,0.6353299906724661,[106.0,36.730079507078415,-95.009765625,69.0,0.0,0.0,0.0])\n(0.0,0.6821234197814827,[106.0,36.84446074079564,-94.833984375,69.0,0.0,0.0,0.0])\n(0.0,1.1426488165569407E-13,[106.0,36.182224980422525,-95.7568359375,61.0,0.0,0.0,0.0])\n(0.0,9.409935610162112E-50,[106.0,38.14319750166766,-91.29638671875,37.0,0.0,0.0,0.0])\n(0.0,1.1674227204042123E-32,[106.0,36.46547188679816,-95.350341796875,49.0,0.0,0.0,0.0])\n(0.0,1.7447958778276784E-32,[106.0,36.730079507078415,-95.009765625,49.0,0.0,0.0,0.0])\n(0.0,9.417915885421603E-52,[106.0,36.659606226479696,-95.1416015625,37.0,0.0,0.0,0.0])\n(1.0,1.0,[106.0,38.642617906345265,-90.17578125,88.0,1.0,1.0,0.0])\n(1.0,1.0,[106.0,38.46219172306828,-90.85693359375,92.0,1.0,1.0,1.0])\n(1.0,1.0,[106.0,37.80544394934273,-92.30712890625,96.0,0.0,0.0,0.0])\n(0.0,1.0,[106.0,36.36822190085111,-95.504150390625,88.0,0.0,0.0,1.0])\n(0.0,1.0,[106.0,36.36822190085111,-95.504150390625,84.0,0.0,0.0,0.0])\n(0.0,1.0,[106.0,36.659606226479696,-95.1416015625,86.0,0.0,0.0,0.0])\n(0.0,1.0,[106.0,36.730079507078415,-95.009765625,86.0,0.0,0.0,0.0])\n(1.0,1.0,[106.0,37.50972584293751,-92.889404296875,98.0,0.0,0.0,1.0])\n(0.0,1.0,[106.0,36.659606226479696,-95.1416015625,96.0,0.0,0.0,0.0])\n(0.0,1.0,[106.0,36.25313319699069,-95.69091796875,98.0,0.0,0.0,0.0])\n(0.0,1.0,[106.0,36.1733569352216,-95.987548828125,94.0,0.0,0.0,0.0])\n(0.0,1.0,[106.0,36.36822190085111,-95.504150390625,94.0,0.0,0.0,0.0])\n"}]},"apps":[],"jobName":"paragraph_1490307733036_-1046092780","id":"20170217-000736_1840013849","dateCreated":"2017-03-23T22:22:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:385","user":"anonymous","dateFinished":"2017-03-23T22:44:16+0000","dateStarted":"2017-03-23T22:43:56+0000"},{"text":"import java.io._\nnew PrintWriter(\"/tmp/trucking.pmml\") { write(model.toPMML); close }\n","dateUpdated":"2017-03-23T22:44:21+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport java.io._\n\nres25: java.io.PrintWriter = $iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$anon$1@34d1478b\n"}]},"apps":[],"jobName":"paragraph_1490307733037_-1046477529","id":"20170217-000753_1850195588","dateCreated":"2017-03-23T22:22:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:386","user":"anonymous","dateFinished":"2017-03-23T22:44:23+0000","dateStarted":"2017-03-23T22:44:21+0000"},{"text":"%sh\nhadoop fs -put /tmp/trucking.pmml /tmp/trucking/models/model.pmml","dateUpdated":"2017-03-23T22:44:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":[],"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sh"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490307733037_-1046477529","id":"20170224-093101_1549942035","dateCreated":"2017-03-23T22:22:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:387","user":"anonymous","dateFinished":"2017-03-23T22:44:31+0000","dateStarted":"2017-03-23T22:44:25+0000"},{"dateUpdated":"2017-03-23T22:22:13+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490307733038_-1045323282","id":"20170224-091428_1880667127","dateCreated":"2017-03-23T22:22:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:388"}],"name":"Trucking Analysis","id":"2CBFEPQS1","angularObjects":{"2CBJ8JPAK:shared_process":[],"2CCP9KMK8:shared_process":[],"2CDWWAH8K:shared_process":[],"2CB8S1EA7:shared_process":[],"2CBRQQMP6:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CCM884M8:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}